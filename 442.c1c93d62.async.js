"use strict";(self.webpackChunkreact_book_reader_docs=self.webpackChunkreact_book_reader_docs||[]).push([[442],{30442:function(X,R,N){N.r(R),N.d(R,{FixedLayout:function(){return J}});var K=Object.defineProperty,Q=(s,t,e)=>t in s?K(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,G=(s,t,e)=>(Q(s,typeof t!="symbol"?t+"":t,e),e),B=(s,t,e)=>{if(!t.has(s))throw TypeError("Cannot "+e)},n=(s,t,e)=>(B(s,t,"read from private field"),e?e.call(s):t.get(s)),c=(s,t,e)=>{if(t.has(s))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(s):t.set(s,e)},f=(s,t,e,i)=>(B(s,t,"write to private field"),i?i.call(s,e):t.set(s,e),e),d=(s,t,e)=>(B(s,t,"access private method"),e);const I=s=>{var t,e;return(e=(t=s?.split(/[,;\s]/))==null?void 0:t.filter(i=>i))==null?void 0:e.map(i=>i.split("=").map(h=>h.trim()))},U=(s,t)=>{var e,i;if(s.documentElement.localName==="svg"){const[,,r,l]=((e=s.documentElement.getAttribute("viewBox"))==null?void 0:e.split(/\s/))??[];return{width:r,height:l}}const h=I((i=s.querySelector('meta[name="viewport"]'))==null?void 0:i.getAttribute("content"));if(h)return Object.fromEntries(h);if(typeof t=="string")return I(t);if(t)return t;const a=s.querySelector("img");return a?{width:a.naturalWidth,height:a.naturalHeight}:(console.warn(new Error("Missing viewport properties")),{width:1e3,height:2e3})};var x,T,y,b,E,g,w,m,k,M,A,S,O,j,V,$,z,F,D,C,L;class J extends HTMLElement{constructor(){super(),c(this,M),c(this,S),c(this,j),c(this,$),c(this,F),c(this,C),c(this,x,this.attachShadow({mode:"closed"})),c(this,T,new ResizeObserver(()=>d(this,S,O).call(this))),c(this,y,void 0),c(this,b,-1),G(this,"defaultViewport"),G(this,"spread"),c(this,E,!1),c(this,g,void 0),c(this,w,void 0),c(this,m,void 0),c(this,k,void 0);const t=new CSSStyleSheet;n(this,x).adoptedStyleSheets=[t],t.replaceSync(`:host {
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }`),n(this,T).observe(this)}open(t){this.book=t;const{rendition:e}=t;this.spread=e?.spread,this.defaultViewport=e?.viewport;const i=t.dir==="rtl",h=!i;this.rtl=i,e?.spread==="none"?f(this,y,t.sections.map(a=>({center:a}))):f(this,y,t.sections.reduce((a,r)=>{const l=a[a.length-1],{linear:p,pageSpread:v}=r;if(p==="no")return a;const o=()=>{const u={};return a.push(u),u};if(v==="center"){const u=l.left||l.right?o():l;u.center=r}else if(v==="left"){const u=l.center||l.left||h?o():l;u.left=r}else if(v==="right"){const u=l.center||l.right||i?o():l;u.right=r}else h?l.center||l.right?o().left=r:l.left?l.right=r:l.left=r:l.center||l.left?o().right=r:l.right?l.left=r:l.right=r;return a},[{}]))}get index(){const t=n(this,y)[n(this,b)],e=t?.center??(this.side==="left"?t.left??t.right:t.right??t.left);return this.book.sections.indexOf(e)}getSpreadOf(t){const e=n(this,y);for(let i=0;i<e.length;i++){const{left:h,right:a,center:r}=e[i];if(h===t)return{index:i,side:"left"};if(a===t)return{index:i,side:"right"};if(r===t)return{index:i,side:"center"}}}async goToSpread(t,e,i){var h,a,r,l,p,v;if(t<0||t>n(this,y).length-1)return;if(t===n(this,b)){d(this,S,O).call(this,e);return}f(this,b,t);const o=n(this,y)[t];if(o.center){const u=this.book.sections.indexOf(o.center),W=await((a=(h=o.center)==null?void 0:h.load)==null?void 0:a.call(h));await d(this,j,V).call(this,{center:{index:u,src:W}})}else{const u=this.book.sections.indexOf(o.left),W=this.book.sections.indexOf(o.right),H=await((l=(r=o.left)==null?void 0:r.load)==null?void 0:l.call(r)),_=await((v=(p=o.right)==null?void 0:p.load)==null?void 0:v.call(p)),q={index:u,src:H},P={index:W,src:_};await d(this,j,V).call(this,{left:q,right:P,side:e})}d(this,C,L).call(this,i)}async select(t){await this.goTo(t)}async goTo(t){const{book:e}=this,i=await t,h=e.sections[i.index];if(!h)return;const{index:a,side:r}=this.getSpreadOf(h);await this.goToSpread(a,r)}async next(){if(this.rtl?d(this,$,z).call(this):d(this,F,D).call(this))d(this,C,L).call(this,"page");else return this.goToSpread(n(this,b)+1,this.rtl?"right":"left","page")}async prev(){if(this.rtl?d(this,F,D).call(this):d(this,$,z).call(this))d(this,C,L).call(this,"page");else return this.goToSpread(n(this,b)-1,this.rtl?"left":"right","page")}getContents(){return Array.from(n(this,x).querySelectorAll("iframe"),t=>({doc:t.contentDocument}))}destroy(){n(this,T).unobserve(this)}}x=new WeakMap,T=new WeakMap,y=new WeakMap,b=new WeakMap,E=new WeakMap,g=new WeakMap,w=new WeakMap,m=new WeakMap,k=new WeakMap,M=new WeakSet,A=async function({index:s,src:t}){const e=document.createElement("div"),i=document.createElement("iframe");return e.append(i),Object.assign(i.style,{border:"0",display:"none",overflow:"hidden"}),i.setAttribute("sandbox","allow-same-origin allow-scripts"),i.setAttribute("scrolling","no"),i.setAttribute("part","filter"),n(this,x).append(e),t?new Promise(h=>{const a=()=>{i.removeEventListener("load",a);const r=i.contentDocument;this.dispatchEvent(new CustomEvent("load",{detail:{doc:r,index:s}}));const{width:l,height:p}=U(r,this.defaultViewport);h({element:e,iframe:i,width:parseFloat(l),height:parseFloat(p)})};i.addEventListener("load",a),i.src=t}):{blank:!0,element:e,iframe:i}},S=new WeakSet,O=function(s=n(this,k)){if(!s)return;const t=n(this,g)??{},e=n(this,m)??n(this,w),i=s==="left"?t:e,{width:h,height:a}=this.getBoundingClientRect(),r=this.spread!=="both"&&this.spread!=="portrait"&&a>h;f(this,E,r);const l=t.width??e.width,p=t.height??e.height,v=r||n(this,m)?Math.min(h/(i.width??l),a/(i.height??p)):Math.min(h/((t.width??l)+(e.width??l)),a/Math.max(t.height??p,e.height??p)),o=u=>{const{element:W,iframe:H,width:_,height:q,blank:P}=u;Object.assign(H.style,{width:`${_}px`,height:`${q}px`,transform:`scale(${v})`,transformOrigin:"top left",display:P?"none":"block"}),Object.assign(W.style,{width:`${(_??l)*v}px`,height:`${(q??p)*v}px`,overflow:"hidden",display:"block"}),r&&u!==i&&(W.style.display="none")};n(this,m)?o(n(this,m)):(o(t),o(e))},j=new WeakSet,V=async function({left:s,right:t,center:e,side:i}){n(this,x).replaceChildren(),f(this,g,null),f(this,w,null),f(this,m,null),e?(f(this,m,await d(this,M,A).call(this,e)),f(this,k,"center"),d(this,S,O).call(this)):(f(this,g,await d(this,M,A).call(this,s)),f(this,w,await d(this,M,A).call(this,t)),f(this,k,n(this,g).blank?"right":n(this,w).blank?"left":i),d(this,S,O).call(this))},$=new WeakSet,z=function(){var s,t,e,i;if(!(n(this,m)||(s=n(this,g))!=null&&s.blank)&&n(this,E)&&((i=(e=(t=n(this,g))==null?void 0:t.element)==null?void 0:e.style)==null?void 0:i.display)==="none")return n(this,w).element.style.display="none",n(this,g).element.style.display="block",f(this,k,"left"),!0},F=new WeakSet,D=function(){var s,t,e,i;if(!(n(this,m)||(s=n(this,w))!=null&&s.blank)&&n(this,E)&&((i=(e=(t=n(this,w))==null?void 0:t.element)==null?void 0:e.style)==null?void 0:i.display)==="none")return n(this,g).element.style.display="none",n(this,w).element.style.display="block",f(this,k,"right"),!0},C=new WeakSet,L=function(s){this.dispatchEvent(new CustomEvent("relocate",{detail:{reason:s,range:null,index:this.index,fraction:0,size:1}}))},customElements.define("foliate-fxl",J)}}]);
