"use strict";(self.webpackChunkreact_book_reader_docs=self.webpackChunkreact_book_reader_docs||[]).push([[826],{60826:function(pe,Nt,Ft){Ft.r(Nt),Ft.d(Nt,{Paginator:function(){return Vt}});var Zt=Object.defineProperty,te=(s,t,i)=>t in s?Zt(s,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[t]=i,ee=(s,t,i)=>(te(s,typeof t!="symbol"?t+"":t,i),i),Wt=(s,t,i)=>{if(!t.has(s))throw TypeError("Cannot "+i)},e=(s,t,i)=>(Wt(s,t,"read from private field"),i?i.call(s):t.get(s)),o=(s,t,i)=>{if(t.has(s))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(s):t.set(s,i)},d=(s,t,i,n)=>(Wt(s,t,"write to private field"),n?n.call(s,i):t.set(s,i),i),l=(s,t,i)=>(Wt(s,t,"access private method"),i);const ie=s=>new Promise(t=>setTimeout(t,s)),se=(s,t,i)=>{let n;return(...a)=>{const h=()=>{n=null,i||s(...a)},r=i&&!n;n&&clearTimeout(n),n=setTimeout(h,t),r&&s(...a)}},ne=(s,t,i)=>i*(t-s)+s,ae=s=>1-(1-s)*(1-s),he=(s,t,i,n,a)=>new Promise(h=>{let r;const c=p=>{r??(r=p);const u=Math.min(1,(p-r)/i);a(ne(s,t,n(u))),u<1?requestAnimationFrame(c):h()};requestAnimationFrame(c)}),re=s=>{if(!(s!=null&&s.collapsed))return s;const{endOffset:t,endContainer:i}=s;if(i.nodeType===1)return i;if(t+1<i.length)s.setEnd(i,t+1);else if(t>1)s.setStart(i,t-1);else return i.parentNode;return s},ht=(s,t,i,n=i)=>{const a=s.createRange();return a.setStart(t,i),a.setEnd(t,n),a},rt=(s,t,i,n=0,a=t.nodeValue.length)=>{if(a-n===1)return i(ht(s,t,n),ht(s,t,a))<0?n:a;const h=Math.floor(n+(a-n)/2),r=i(ht(s,t,n,h),ht(s,t,h,a));return r<0?rt(s,t,i,n,h):r>0?rt(s,t,i,h,a):h},{SHOW_ELEMENT:oe,SHOW_TEXT:le,SHOW_CDATA_SECTION:ce,FILTER_ACCEPT:jt,FILTER_REJECT:Dt,FILTER_SKIP:Ht}=NodeFilter,de=oe|le|ce,qt=(s,t,i,n)=>{const a=f=>{var W,S;const y=(W=f.localName)==null?void 0:W.toLowerCase();if(y==="script"||y==="style")return Dt;if(f.nodeType===1){const{left:P,right:F}=n(f.getBoundingClientRect());if(F<t||P>i)return Dt;if(P>=t&&F<=i)return jt}else{if(!((S=f.nodeValue)!=null&&S.trim()))return Ht;const P=s.createRange();P.selectNodeContents(f);const{left:F,right:Et}=n(P.getBoundingClientRect());if(Et>=t&&F<=i)return jt}return Ht},h=s.createTreeWalker(s.body,de,{acceptNode:a}),r=[];for(let f=h.nextNode();f;f=h.nextNode())r.push(f);const c=r[0]??s.body,p=r[r.length-1]??c,u=c.nodeType===1?0:rt(s,c,(f,W)=>{const S=n(f.getBoundingClientRect()),y=n(W.getBoundingClientRect());return S.right<t&&y.left>t?0:y.left>t?-1:1}),g=p.nodeType===1?0:rt(s,p,(f,W)=>{const S=n(f.getBoundingClientRect()),y=n(W.getBoundingClientRect());return S.right<i&&y.left>i?0:y.left>i?-1:1}),w=s.createRange();return w.setStart(c,u),w.setEnd(p,g),w},ue=s=>{const{defaultView:t}=s,{writingMode:i,direction:n}=t.getComputedStyle(s.body),a=i==="vertical-rl"||i==="vertical-lr",h=s.body.dir==="rtl"||n==="rtl"||s.documentElement.dir==="rtl";return{vertical:a,rtl:h}},St=s=>{const t=s.defaultView.getComputedStyle(s.body);return t.backgroundColor==="rgba(0, 0, 0, 0)"&&t.backgroundImage==="none"?s.defaultView.getComputedStyle(s.documentElement).background:t.background},Xt=(s,t)=>Array.from({length:s},()=>{const i=document.createElement("div"),n=document.createElement("div");return i.append(n),n.setAttribute("part",t),i}),G=(s,t)=>{const{style:i}=s;for(const[n,a]of Object.entries(t))i.setProperty(n,a,"important")};var ot,k,v,lt,x,b,ct,Q,C,U;class me{constructor({container:t,onExpand:i}){o(this,ot,new ResizeObserver(()=>this.expand())),o(this,k,document.createElement("div")),o(this,v,document.createElement("iframe")),o(this,lt,document.createRange()),o(this,x,void 0),o(this,b,!1),o(this,ct,!1),o(this,Q,!0),o(this,C,void 0),o(this,U,{}),this.container=t,this.onExpand=i,e(this,v).setAttribute("part","filter"),e(this,k).append(e(this,v)),Object.assign(e(this,k).style,{boxSizing:"content-box",position:"relative",overflow:"hidden",flex:"0 0 auto",width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"}),Object.assign(e(this,v).style,{overflow:"hidden",border:"0",display:"none",width:"100%",height:"100%"}),e(this,v).setAttribute("sandbox","allow-same-origin allow-scripts"),e(this,v).setAttribute("scrolling","no")}get element(){return e(this,k)}get document(){return e(this,v).contentDocument}async load(t,i,n){if(typeof t!="string")throw new Error(`${t} is not string`);return new Promise(a=>{e(this,v).addEventListener("load",()=>{const h=this.document;i?.(h),e(this,v).style.display="block";const{vertical:r,rtl:c}=ue(h),p=St(h);e(this,v).style.display="none",d(this,b,r),d(this,ct,c),e(this,lt).selectNodeContents(h.body);const u=n?.({vertical:r,rtl:c,background:p});e(this,v).style.display="block",this.render(u),e(this,ot).observe(h.body),h.fonts.ready.then(()=>this.expand()),a()},{once:!0}),e(this,v).src=t})}render(t){t&&(d(this,Q,t.flow!=="scrolled"),d(this,U,t),e(this,Q)?this.columnize(t):this.scrolled(t))}scrolled({gap:t,columnWidth:i}){const n=e(this,b),a=this.document;G(a.documentElement,{"box-sizing":"border-box",padding:n?`${t}px 0`:`0 ${t}px`,"column-width":"auto",height:"auto",width:"auto"}),G(a.body,{[n?"max-height":"max-width"]:`${i}px`,margin:"auto"}),this.setImageSize(),this.expand()}columnize({width:t,height:i,gap:n,columnWidth:a}){const h=e(this,b);d(this,C,h?i:t);const r=this.document;G(r.documentElement,{"box-sizing":"border-box","column-width":`${Math.trunc(a)}px`,"column-gap":`${n}px`,"column-fill":"auto",...h?{width:`${t}px`}:{height:`${i}px`},padding:h?`${n/2}px 0`:`0 ${n/2}px`,overflow:"hidden","overflow-wrap":"break-word",position:"static",border:"0",margin:"0","max-height":"none","max-width":"none","min-height":"none","min-width":"none","-webkit-line-box-contain":"block glyphs replaced"}),G(r.body,{"max-height":"none","max-width":"none",margin:"0"}),this.setImageSize(),this.expand()}setImageSize(){const{width:t,height:i,margin:n}=e(this,U),a=e(this,b),h=this.document;for(const r of h.body.querySelectorAll("img, svg, video")){const{maxHeight:c,maxWidth:p}=h.defaultView.getComputedStyle(r);G(r,{"max-height":a?c!=="none"&&c!=="0px"?c:"100%":`${i-n*2}px`,"max-width":a?`${t-n*2}px`:p!=="none"&&p!=="0px"?p:"100%","object-fit":"contain","page-break-inside":"avoid","break-inside":"avoid","box-sizing":"border-box"})}}expand(){const{documentElement:t}=this.document;if(e(this,Q)){const i=e(this,b)?"height":"width",n=e(this,b)?"width":"height",a=e(this,lt).getBoundingClientRect(),h=t.getBoundingClientRect(),r=(e(this,b)?0:e(this,ct)?h.right-a.right:a.left-h.left)+a[i],c=Math.ceil(r/e(this,C))*e(this,C);e(this,k).style.padding="0",e(this,v).style[i]=`${c}px`,e(this,k).style[i]=`${c+e(this,C)*2}px`,e(this,v).style[n]="100%",e(this,k).style[n]="100%",t.style[i]=`${e(this,C)}px`,e(this,x)&&(e(this,x).element.style.margin="0",e(this,x).element.style.left=e(this,b)?"0":`${e(this,C)}px`,e(this,x).element.style.top=e(this,b)?`${e(this,C)}px`:"0",e(this,x).element.style[i]=`${c}px`,e(this,x).redraw())}else{const i=e(this,b)?"width":"height",n=e(this,b)?"height":"width",a=t.getBoundingClientRect()[i],{margin:h}=e(this,U),r=e(this,b)?`0 ${h}px`:`${h}px 0`;e(this,k).style.padding=r,e(this,v).style[i]=`${a}px`,e(this,k).style[i]=`${a}px`,e(this,v).style[n]="100%",e(this,k).style[n]="100%",e(this,x)&&(e(this,x).element.style.margin=r,e(this,x).element.style.left="0",e(this,x).element.style.top="0",e(this,x).element.style[i]=`${a}px`,e(this,x).redraw())}this.onExpand()}set overlayer(t){d(this,x,t),e(this,k).append(t.element)}get overlayer(){return e(this,x)}destroy(){this.document&&e(this,ot).unobserve(this.document.body)}}ot=new WeakMap,k=new WeakMap,v=new WeakMap,lt=new WeakMap,x=new WeakMap,b=new WeakMap,ct=new WeakMap,Q=new WeakMap,C=new WeakMap,U=new WeakMap;var T,dt,A,j,E,B,D,m,M,_,L,z,$,Z,H,ut,mt,pt,tt,I,q,et,Mt,Yt,gt,_t,ft,Ct,vt,zt,wt,Tt,X,it,At,Jt,O,Y,V,J,Lt,Kt,$t,Gt,K,st,xt,Rt,yt,Pt,nt,bt,Bt,Qt,It,Ut,R,N,kt,Ot;class Vt extends HTMLElement{constructor(){super(),o(this,Mt),o(this,gt),o(this,ft),o(this,vt),o(this,wt),o(this,X),o(this,At),o(this,O),o(this,V),o(this,Lt),o(this,$t),o(this,K),o(this,xt),o(this,yt),o(this,nt),o(this,Bt),o(this,It),o(this,R),o(this,kt),o(this,T,this.attachShadow({mode:"closed"})),o(this,dt,new ResizeObserver(()=>this.render())),o(this,A,void 0),o(this,j,void 0),o(this,E,void 0),o(this,B,void 0),o(this,D,void 0),o(this,m,void 0),o(this,M,!1),o(this,_,!1),o(this,L,0),o(this,z,-1),o(this,$,0),o(this,Z,!1),o(this,H,!1),o(this,ut,void 0),o(this,mt,new WeakMap),o(this,pt,matchMedia("(prefers-color-scheme: dark)")),o(this,tt,void 0),o(this,I,void 0),o(this,q,void 0),o(this,et,void 0),e(this,T).innerHTML=`<style>
        :host {
            display: block;
            container-type: size;
        }
        :host, #top {
            box-sizing: border-box;
            position: relative;
            overflow: hidden;
            width: 100%;
            height: 100%;
        }
        #top {
            --_gap: 7%;
            --_margin: 48px;
            --_max-inline-size: 720px;
            --_max-block-size: 1440px;
            --_max-column-count: 2;
            --_max-column-count-portrait: 1;
            --_max-column-count-spread: var(--_max-column-count);
            --_half-gap: calc(var(--_gap) / 2);
            --_max-width: calc(var(--_max-inline-size) * var(--_max-column-count-spread));
            --_max-height: var(--_max-block-size);
            display: grid;
            grid-template-columns:
                minmax(var(--_half-gap), 1fr)
                var(--_half-gap)
                minmax(0, calc(var(--_max-width) - var(--_gap)))
                var(--_half-gap)
                minmax(var(--_half-gap), 1fr);
            grid-template-rows:
                minmax(var(--_margin), 1fr)
                minmax(0, var(--_max-height))
                minmax(var(--_margin), 1fr);
            &.vertical {
                --_max-column-count-spread: var(--_max-column-count-portrait);
                --_max-width: var(--_max-block-size);
                --_max-height: calc(var(--_max-inline-size) * var(--_max-column-count-spread));
            }
            @container (orientation: portrait) {
                & {
                    --_max-column-count-spread: var(--_max-column-count-portrait);
                }
                &.vertical {
                    --_max-column-count-spread: var(--_max-column-count);
                }
            }
        }
        #background {
            grid-column: 1 / -1;
            grid-row: 1 / -1;
        }
        #container {
            grid-column: 2 / 5;
            grid-row: 2;
            overflow: hidden;
        }
        :host([flow="scrolled"]) #container {
            grid-column: 1 / -1;
            grid-row: 1 / -1;
            overflow: auto;
        }
        #header {
            grid-column: 3 / 4;
            grid-row: 1;
        }
        #footer {
            grid-column: 3 / 4;
            grid-row: 3;
            align-self: end;
        }
        #header, #footer {
            display: grid;
            height: var(--_margin);
        }
        :is(#header, #footer) > * {
            display: flex;
            align-items: center;
            min-width: 0;
        }
        :is(#header, #footer) > * > * {
            width: 100%;
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
            text-align: center;
            font-size: .75em;
            opacity: .6;
        }
        </style>
        <div id="top">
            <div id="background" part="filter"></div>
            <div id="header"></div>
            <div id="container"></div>
            <div id="footer"></div>
        </div>
        `,d(this,A,e(this,T).getElementById("top")),d(this,j,e(this,T).getElementById("background")),d(this,E,e(this,T).getElementById("container")),d(this,B,e(this,T).getElementById("header")),d(this,D,e(this,T).getElementById("footer")),e(this,dt).observe(e(this,E)),e(this,E).addEventListener("scroll",se(()=>{this.scrolled&&(e(this,Z)?d(this,Z,!1):l(this,K,st).call(this,"scroll"))},250));const t={passive:!1};this.addEventListener("touchstart",l(this,ft,Ct).bind(this),t),this.addEventListener("touchmove",l(this,vt,zt).bind(this),t),this.addEventListener("touchend",l(this,wt,Tt).bind(this)),this.addEventListener("load",({detail:{doc:i}})=>{i.addEventListener("touchstart",l(this,ft,Ct).bind(this),t),i.addEventListener("touchmove",l(this,vt,zt).bind(this),t),i.addEventListener("touchend",l(this,wt,Tt).bind(this))}),d(this,tt,()=>{e(this,m)&&(e(this,j).style.background=St(e(this,m).document))}),e(this,pt).addEventListener("change",e(this,tt))}attributeChangedCallback(t,i,n){switch(t){case"flow":this.render();break;case"gap":case"margin":case"max-block-size":case"max-column-count":e(this,A).style.setProperty("--_"+t,n);break;case"max-inline-size":e(this,A).style.setProperty("--_"+t,n),this.render();break}}open(t){this.bookDir=t.dir,this.sections=t.sections}render(){e(this,m)&&(e(this,m).render(l(this,gt,_t).call(this,{vertical:e(this,M),rtl:e(this,_)})),this.scrollToAnchor(e(this,$)))}get scrolled(){return this.getAttribute("flow")==="scrolled"}get scrollProp(){const{scrolled:t}=this;return e(this,M)?t?"scrollLeft":"scrollTop":t?"scrollTop":"scrollLeft"}get sideProp(){const{scrolled:t}=this;return e(this,M)?t?"width":"height":t?"height":"width"}get size(){return e(this,E).getBoundingClientRect()[this.sideProp]}get viewSize(){return e(this,m).element.getBoundingClientRect()[this.sideProp]}get start(){return Math.abs(e(this,E)[this.scrollProp])}get end(){return this.start+this.size}get page(){return Math.floor((this.start+this.end)/2/this.size)}get pages(){return Math.round(this.viewSize/this.size)}scrollBy(t,i){const n=e(this,M)?i:t,a=e(this,E),{scrollProp:h}=this,[r,c,p]=e(this,I),u=e(this,_),g=u?r-p:r-c,w=u?r+c:r+p;a[h]=Math.max(g,Math.min(w,a[h]+n))}snap(t,i){const n=e(this,M)?i:t,[a,h,r]=e(this,I),{start:c,end:p,pages:u,size:g}=this,w=Math.abs(a)-h,f=Math.abs(a)+r,W=n*(e(this,_)?-g:g),S=Math.floor(Math.max(w,Math.min(f,(c+p)/2+(isNaN(W)?0:W)))/g);l(this,V,J).call(this,S,"snap").then(()=>{const y=S<=0?-1:S>=u-1?1:null;if(y)return l(this,nt,bt).call(this,{index:l(this,R,N).call(this,y),anchor:y<0?()=>1:()=>0})})}async scrollToAnchor(t,i){var n,a;d(this,$,t);const h=(a=(n=re(t))==null?void 0:n.getClientRects)==null?void 0:a.call(n);if(h){const u=Array.from(h).find(g=>g.width>0&&g.height>0)||h[0];if(!u)return;await l(this,At,Jt).call(this,u,"anchor"),i&&l(this,Lt,Kt).call(this);return}if(this.scrolled){await l(this,O,Y).call(this,t*this.viewSize,"anchor");return}const{pages:r}=this;if(!r)return;const c=r-2,p=Math.round(t*(c-1));await l(this,V,J).call(this,p+1,"anchor")}async goTo(t){if(e(this,H))return;const i=await t;if(l(this,yt,Pt).call(this,i.index))return l(this,nt,bt).call(this,i)}get atStart(){return l(this,R,N).call(this,-1)==null&&this.page<=1}get atEnd(){return l(this,R,N).call(this,1)==null&&this.page>=this.pages-2}prev(t){return l(this,kt,Ot).call(this,-1,t)}next(t){return l(this,kt,Ot).call(this,1,t)}prevSection(){return this.goTo({index:l(this,R,N).call(this,-1)})}nextSection(){return this.goTo({index:l(this,R,N).call(this,1)})}firstSection(){const t=this.sections.findIndex(i=>i.linear!=="no");return this.goTo({index:t})}lastSection(){const t=this.sections.findLastIndex(i=>i.linear!=="no");return this.goTo({index:t})}getContents(){return e(this,m)?[{index:e(this,z),overlayer:e(this,m).overlayer,doc:e(this,m).document}]:[]}setStyles(t){var i,n,a,h,r;d(this,ut,t);const c=e(this,mt).get((i=e(this,m))==null?void 0:i.document);if(!c)return;const[p,u]=c;if(Array.isArray(t)){const[g,w]=t;p.textContent=g,u.textContent=w}else u.textContent=t;e(this,j).style.background=St(e(this,m).document),(r=(h=(a=(n=e(this,m))==null?void 0:n.document)==null?void 0:a.fonts)==null?void 0:h.ready)==null||r.then(()=>e(this,m).expand())}destroy(){var t,i;e(this,dt).unobserve(this),e(this,m).destroy(),d(this,m,null),(i=(t=this.sections[e(this,z)])==null?void 0:t.unload)==null||i.call(t),e(this,pt).removeEventListener("change",e(this,tt))}}T=new WeakMap,dt=new WeakMap,A=new WeakMap,j=new WeakMap,E=new WeakMap,B=new WeakMap,D=new WeakMap,m=new WeakMap,M=new WeakMap,_=new WeakMap,L=new WeakMap,z=new WeakMap,$=new WeakMap,Z=new WeakMap,H=new WeakMap,ut=new WeakMap,mt=new WeakMap,pt=new WeakMap,tt=new WeakMap,I=new WeakMap,q=new WeakMap,et=new WeakMap,Mt=new WeakSet,Yt=function(){return e(this,m)&&(e(this,m).destroy(),e(this,E).removeChild(e(this,m).element)),d(this,m,new me({container:this,onExpand:()=>this.scrollToAnchor(e(this,$))})),e(this,E).append(e(this,m).element),e(this,m)},gt=new WeakSet,_t=function({vertical:s,rtl:t,background:i}){d(this,M,s),d(this,_,t),e(this,A).classList.toggle("vertical",s),e(this,j).style.background=i;const{width:n,height:a}=e(this,E).getBoundingClientRect(),h=s?a:n,r=getComputedStyle(e(this,A)),c=parseFloat(r.getPropertyValue("--_max-inline-size")),p=parseInt(r.getPropertyValue("--_max-column-count-spread")),u=parseFloat(r.getPropertyValue("--_margin"));d(this,L,u);const g=parseFloat(r.getPropertyValue("--_gap"))/100,w=-g/(g-1)*h,f=this.getAttribute("flow");if(f==="scrolled"){this.setAttribute("dir",s?"rtl":"ltr"),e(this,A).style.padding="0";const at=c;return this.heads=null,this.feet=null,e(this,B).replaceChildren(),e(this,D).replaceChildren(),{flow:f,margin:u,gap:w,columnWidth:at}}const W=Math.min(p,Math.ceil(h/c)),S=h/W-w;this.setAttribute("dir",t?"rtl":"ltr");const y=s?Math.min(2,Math.ceil(n/c)):W,P={gridTemplateColumns:`repeat(${y}, 1fr)`,gap:`${w}px`,direction:this.bookDir==="rtl"?"rtl":"ltr"};Object.assign(e(this,B).style,P),Object.assign(e(this,D).style,P);const F=Xt(y,"head"),Et=Xt(y,"foot");return this.heads=F.map(at=>at.children[0]),this.feet=Et.map(at=>at.children[0]),e(this,B).replaceChildren(...F),e(this,D).replaceChildren(...Et),{height:a,width:n,margin:u,gap:w,columnWidth:S}},ft=new WeakSet,Ct=function(s){const t=s.changedTouches[0];d(this,q,{x:t?.screenX,y:t?.screenY,t:s.timeStamp,vx:0,xy:0})},vt=new WeakSet,zt=function(s){const t=e(this,q);if(t.pinched||(t.pinched=globalThis.visualViewport.scale>1,this.scrolled||t.pinched))return;if(s.touches.length>1){e(this,et)&&s.preventDefault();return}s.preventDefault();const i=s.changedTouches[0],n=i.screenX,a=i.screenY,h=t.x-n,r=t.y-a,c=s.timeStamp-t.t;t.x=n,t.y=a,t.t=s.timeStamp,t.vx=h/c,t.vy=r/c,d(this,et,!0),this.scrollBy(h,r)},wt=new WeakSet,Tt=function(){d(this,et,!1),!this.scrolled&&requestAnimationFrame(()=>{globalThis.visualViewport.scale===1&&this.snap(e(this,q).vx,e(this,q).vy)})},X=new WeakSet,it=function(){if(this.scrolled){const t=this.viewSize,i=e(this,L);return e(this,M)?({left:n,right:a})=>({left:t-a-i,right:t-n-i}):({top:n,bottom:a})=>({left:n+i,right:a+i})}const s=this.pages*this.size;return e(this,_)?({left:t,right:i})=>({left:s-i,right:s-t}):e(this,M)?({top:t,bottom:i})=>({left:t,right:i}):t=>t},At=new WeakSet,Jt=async function(s,t){if(this.scrolled){const n=l(this,X,it).call(this)(s).left-e(this,L);return l(this,O,Y).call(this,n,t)}const i=l(this,X,it).call(this)(s).left+e(this,L)/2;return l(this,V,J).call(this,Math.floor(i/this.size)+(e(this,_)?-1:1),t)},O=new WeakSet,Y=async function(s,t,i){const n=e(this,E),{scrollProp:a,size:h}=this;if(n[a]===s){d(this,I,[s,this.atStart?0:h,this.atEnd?0:h]),l(this,K,st).call(this,t);return}if(this.scrolled&&e(this,M)&&(s=-s),(t==="snap"||i)&&this.hasAttribute("animated"))return he(n[a],s,300,ae,r=>n[a]=r).then(()=>{d(this,I,[s,this.atStart?0:h,this.atEnd?0:h]),l(this,K,st).call(this,t)});n[a]=s,d(this,I,[s,this.atStart?0:h,this.atEnd?0:h]),l(this,K,st).call(this,t)},V=new WeakSet,J=async function(s,t,i){const n=this.size*(e(this,_)?-s:s);return l(this,O,Y).call(this,n,t,i)},Lt=new WeakSet,Kt=function(){const{defaultView:s}=e(this,m).document;if(e(this,$).startContainer){const t=s.getSelection();t.removeAllRanges(),t.addRange(e(this,$))}},$t=new WeakSet,Gt=function(){if(this.scrolled)return qt(e(this,m).document,this.start+e(this,L),this.end-e(this,L),l(this,X,it).call(this));const s=e(this,_)?-this.size:this.size;return qt(e(this,m).document,this.start-s,this.end-s,l(this,X,it).call(this))},K=new WeakSet,st=function(s){const t=l(this,$t,Gt).call(this);s!=="anchor"?d(this,$,t):d(this,Z,!0);const i=e(this,z),n={reason:s,range:t,index:i};if(this.scrolled)n.fraction=this.start/this.viewSize;else if(this.pages>0){const{page:a,pages:h}=this;e(this,B).style.visibility=a>1?"visible":"hidden",n.fraction=(a-1)/(h-2),n.size=1/(h-2)}this.dispatchEvent(new CustomEvent("relocate",{detail:n}))},xt=new WeakSet,Rt=async function(s){const{index:t,src:i,anchor:n,onLoad:a,select:h}=await s;if(d(this,z,t),i){const r=l(this,Mt,Yt).call(this),c=u=>{if(u.head){const g=u.createElement("style");u.head.prepend(g);const w=u.createElement("style");u.head.append(w),e(this,mt).set(u,[g,w])}a?.({doc:u,index:t})},p=l(this,gt,_t).bind(this);await r.load(i,c,p),this.dispatchEvent(new CustomEvent("create-overlayer",{detail:{doc:r.document,index:t,attach:u=>r.overlayer=u}})),d(this,m,r)}await this.scrollToAnchor((typeof n=="function"?n(e(this,m).document):n)??0,h)},yt=new WeakSet,Pt=function(s){return s>=0&&s<=this.sections.length-1},nt=new WeakSet,bt=async function({index:s,anchor:t,select:i}){if(s===e(this,z))await l(this,xt,Rt).call(this,{index:s,anchor:t,select:i});else{const n=e(this,z),a=h=>{var r,c;(c=(r=this.sections[n])==null?void 0:r.unload)==null||c.call(r),this.setStyles(e(this,ut)),this.dispatchEvent(new CustomEvent("load",{detail:h}))};await l(this,xt,Rt).call(this,Promise.resolve(this.sections[s].load()).then(h=>({index:s,src:h,anchor:t,onLoad:a,select:i})).catch(h=>(console.warn(h),console.warn(new Error(`Failed to load section ${s}`)),{})))}},Bt=new WeakSet,Qt=function(s){if(!e(this,m))return!0;if(this.scrolled)return this.start>0?l(this,O,Y).call(this,Math.max(0,this.start-(s??this.size)),null,!0):!0;if(this.atStart)return;const t=this.page-1;return l(this,V,J).call(this,t,"page",!0).then(()=>t<=0)},It=new WeakSet,Ut=function(s){if(!e(this,m))return!0;if(this.scrolled)return this.viewSize-this.end>2?l(this,O,Y).call(this,Math.min(this.viewSize,s?this.start+s:this.end),null,!0):!0;if(this.atEnd)return;const t=this.page+1,i=this.pages;return l(this,V,J).call(this,t,"page",!0).then(()=>t>=i-1)},R=new WeakSet,N=function(s){var t;for(let i=e(this,z)+s;l(this,yt,Pt).call(this,i);i+=s)if(((t=this.sections[i])==null?void 0:t.linear)!=="no")return i},kt=new WeakSet,Ot=async function(s,t){if(e(this,H))return;d(this,H,!0);const i=s===-1,n=await(i?l(this,Bt,Qt).call(this,t):l(this,It,Ut).call(this,t));n&&await l(this,nt,bt).call(this,{index:l(this,R,N).call(this,s),anchor:i?()=>1:()=>0}),(n||!this.hasAttribute("animated"))&&await ie(100),d(this,H,!1)},ee(Vt,"observedAttributes",["flow","gap","margin","max-inline-size","max-block-size","max-column-count"]),customElements.define("foliate-paginator",Vt)}}]);
